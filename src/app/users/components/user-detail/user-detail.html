<div class="user-detail-container">
  <!-- Header with navigation -->
  <div class="detail-header">
    <button mat-icon-button (click)="goBack()" matTooltip="Back to users">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <h1>Detalhes do usuário</h1>
    
    <div class="header-actions" *ngIf="user && !loading">
      <button 
        mat-stroked-button 
        color="accent" 
        (click)="editUser()"
        matTooltip="Edit user">
        <mat-icon>edit</mat-icon>
        Editar
      </button>
      <button 
        mat-stroked-button 
        color="warn" 
        (click)="deleteUser()"
        matTooltip="Excluir usuário">
        <mat-icon>delete</mat-icon>
        Excluir
      </button>
    </div>
  </div>

  <!-- Loading Spinner -->
  <div *ngIf="loading" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Carregando detalhes do usuário...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="error && !loading" class="error-container">
    <mat-card class="error-card">
      <mat-card-content>
        <div class="error-content">
          <mat-icon color="warn">error</mat-icon>
          <div>
            <h3>Erro ao carregar detalhes do usuário</h3>
            <p>{{ error }}</p>
          </div>
        </div>
        <div class="error-actions">
          <button mat-raised-button color="primary" (click)="retryLoad()">
            <mat-icon>refresh</mat-icon>
            Retry
          </button>
          <button mat-stroked-button (click)="goBack()">
            <mat-icon>arrow_back</mat-icon>
            Voltar para a lista
          </button>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- User Details -->
  <div *ngIf="user && !loading && !error" class="user-details">
    <!-- User Profile Card -->
    <mat-card class="profile-card">
      <mat-card-header>
        <div mat-card-avatar class="user-avatar">
          {{ getUserInitials() }}
        </div>
        <mat-card-title>{{ user.name | name }}</mat-card-title>
        <mat-card-subtitle>
          <mat-chip-set>
            <mat-chip [class]="user.status">
              <mat-icon>{{ user.status === 'active' ? 'check_circle' : 'cancel' }}</mat-icon>
              {{ user.status | status }}
            </mat-chip>
          </mat-chip-set>
        </mat-card-subtitle>
      </mat-card-header>
      
      <mat-card-content>
        <div class="profile-details">
          <div class="detail-item">
            <mat-icon>badge</mat-icon>
            <div>
              <span class="label">ID</span>
              <span class="value">#{{ user.id }}</span>
            </div>
          </div>
          
          <div class="detail-item">
            <mat-icon>email</mat-icon>
            <div>
              <span class="label">Email</span>
              <span class="value">
                <a [href]="'mailto:' + user.email">{{ user.email }}</a>
              </span>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Contact Information -->
    <mat-card class="info-card" *ngIf="hasContactInfo()">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>contact_phone</mat-icon>
          Informações de contato
        </mat-card-title>
      </mat-card-header>
      
      <mat-card-content>
        <div class="info-grid">
          <div class="info-item" *ngIf="user.phone">
            <mat-icon>phone</mat-icon>
            <div>
              <span class="label">Telefone</span>
              <span class="value">
                <a [href]="'tel:' + user.phone">{{ user.phone }}</a>
              </span>
            </div>
          </div>
          
          <div class="info-item" *ngIf="user.website">
            <mat-icon>language</mat-icon>
            <div>
              <span class="label">Website</span>
              <span class="value">
                <a [href]="'https://' + user.website" target="_blank" rel="noopener">
                  {{ user.website }}
                  <mat-icon>open_in_new</mat-icon>
                </a>
              </span>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Address Information -->
    <mat-card class="info-card" *ngIf="user.address">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>location_on</mat-icon>
          Endereço
        </mat-card-title>
      </mat-card-header>
      
      <mat-card-content>
        <div class="address-details">
          <div class="address-main">
            <mat-icon>home</mat-icon>
            <div>
              <span class="label">Endereço</span>
              <span class="value">{{ getFormattedAddress() }}</span>
            </div>
          </div>
          
          <div class="address-geo" *ngIf="user.address.geo">
            <mat-icon>my_location</mat-icon>
            <div>
              <span class="label">Coordenadas</span>
              <span class="value">
                {{ user.address.geo.lat }}, {{ user.address.geo.lng }}
                <a 
                  [href]="'https://maps.google.com/?q=' + user.address.geo.lat + ',' + user.address.geo.lng" 
                  target="_blank" 
                  rel="noopener"
                  matTooltip="Open in Google Maps">
                  <mat-icon>map</mat-icon>
                </a>
              </span>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Company Information -->
    <mat-card class="info-card" *ngIf="hasCompanyInfo()">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>business</mat-icon>
          Empresa
        </mat-card-title>
      </mat-card-header>
      
      <mat-card-content>
        <div class="company-details">
          <div class="company-item">
            <mat-icon>business_center</mat-icon>
            <div>
              <span class="label">Nome da empresa</span>
              <span class="value">{{ user.company?.name }}</span>
            </div>
          </div>
          
          <div class="company-item" *ngIf="user.company?.catchPhrase">
            <mat-icon>format_quote</mat-icon>
            <div>
              <span class="label">Slogan</span>
              <span class="value">"{{ user.company?.catchPhrase }}"</span>
            </div>
          </div>
          
          <div class="company-item" *ngIf="user.company?.bs">
            <mat-icon>trending_up</mat-icon>
            <div>
              <span class="label">Ramo de atividade</span>
              <span class="value">{{ user.company?.bs }}</span>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>